<!-- AdditiveSplitting BPEL Process [Generated by the Eclipse BPEL Designer]  -->
<!-- Date: Mon Jun 17 04:09:47 PDT 2013 -->

<bpel:process name="AdditiveSplitting"
         targetNamespace="http://additivesplitting.bpelprocess"
         suppressJoinFailure="yes"  exitOnStandardFault="yes"
         xmlns:tns="http://additivesplitting.bpelprocess"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ns="http://www.cloudservices.org/MatServ/"
         xmlns:ns1="http://www.brokerservices.org/MatServ/"
    	 xmlns:xsd="http://www.w3.org/2001/XMLSchema"
    	 xmlns:ode="http://www.apache.org/ode/type/extension">
         >
    <!-- Import the client WSDL -->
	<bpel:import location="AdditiveSplittingArtifacts.wsdl" namespace="http://additivesplitting.bpelprocess" 
	        importType="http://schemas.xmlsoap.org/wsdl/" />
	        
    <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="CloudServices.wsdl" namespace="http://www.cloudservices.org/MatServ/"/>
   
   <bpel:import importType="http://schemas.xmlsoap.org/wsdl/"
        location="BrokerServices.wsdl" namespace="http://www.brokerservices.org/MatServ/"/>
   
    <!-- ================================================================= -->         
    <!-- PARTNERLINKS                                                      -->
    <!-- List of services participating in this BPEL process               -->
    <!-- ================================================================= -->         
    <bpel:partnerLinks>
        <!--
        The 'client' role represents the requester of this service. It is 
        used for callback. The location and correlation information associated
        with the client role are automatically set using WS-Addressing.
        -->
        <bpel:partnerLink name="client"
                     partnerLinkType="tns:AdditiveSplitting"
                     myRole="AdditiveSplittingProvider"
                     
                     />
        <bpel:partnerLink name="callback_PL"
                     partnerLinkType="tns:AdditiveSplitting"
                     myRole="AdditiveSplittingProvider"
                     
                     />
         <bpel:partnerLink name="OnCloud1_PL"
                     partnerLinkType="tns:Cloud_PL"
                     partnerRole="CloudServicesProvider"
                     />
          <bpel:partnerLink name="OnBroker_PL"
                     partnerLinkType="tns:Broker_PL"
                     partnerRole="BrokerServicesProvider"
                     />
        <bpel:partnerLink name="OnCloud2_PL" partnerLinkType="tns:Cloud_PL" partnerRole="CloudServicesProvider"></bpel:partnerLink>
        <bpel:partnerLink name="OnCloud3_PL" partnerLinkType="tns:Cloud_PL" partnerRole="CloudServicesProvider"></bpel:partnerLink>
        <bpel:partnerLink name="OnCloud4_PL" partnerLinkType="tns:Cloud_PL" partnerRole="CloudServicesProvider"></bpel:partnerLink>
    </bpel:partnerLinks>
    
  
    <!-- ================================================================= -->         
    <!-- VARIABLES                                                         -->
    <!-- List of messages and XML documents used within this BPEL process  -->
    <!-- ================================================================= -->         
    <bpel:variables>
        <!-- Reference to the message passed as input during initiation -->
        <bpel:variable name="input"
                  messageType="tns:AdditiveSplittingRequestMessage"/>
                  
        <!-- Reference to the message that will be sent back to the 
             requester during callback
             -->
        <bpel:variable name="output"
                  messageType="tns:AdditiveSplittingResponseMessage"/>
                  
         <bpel:variable messageType="ns:multiplyRequest" name="A1B1_PLRequest"/>
        <bpel:variable messageType="ns:multiplyRequest" name="A2B2_PLRequest"/>
        <bpel:variable messageType="ns:multiplyRequest" name="A1B2_PLRequest"/>
        <bpel:variable messageType="ns:multiplyRequest" name="A2B1_PLRequest"/>
        <bpel:variable messageType="ns1:addRequest" name="add_PLRequest"/>
        <bpel:variable messageType="ns1:resplitRequest" name="resplit_PLRequest"/>
        
        <bpel:variable name="JOB" type="xsd:string"/>
        
        <bpel:variable messageType="tns:callbackRequestMessage_1" name="callbackRequest_1"/>
        <bpel:variable messageType="tns:callbackRequestMessage_1" name="callbackRequest_2"/>
        <bpel:variable messageType="tns:callbackRequestMessage_1" name="callbackRequest_3"/>
		<bpel:variable messageType="tns:callbackRequestMessage_1" name="callbackRequest_4"/>
		<bpel:variable messageType="tns:callbackRequestMessage_1" name="callbackRequest_5"/>        
        <bpel:variable  messageType="tns:callbackRequestMessage_0" name="callbackRequest_0"/>
    </bpel:variables>

	 <bpel:correlationSets>
        <!--  <bpel:correlationSet name="JOB_CS" properties="tns:jobid_CS"/>-->
        <bpel:correlationSet name="SUB_JOB_CS" properties="tns:sub_jobid_CS"/>
        <bpel:correlationSet name="OP1_CS" properties="tns:op1_CS"/>
        <bpel:correlationSet name="OP2_CS" properties="tns:op2_CS"/>
        <bpel:correlationSet name="OP3_CS" properties="tns:op3_CS"/>
        <bpel:correlationSet name="OP4_CS" properties="tns:op4_CS"/>
        <bpel:correlationSet name="OP5_CS" properties="tns:op5_CS"/>
        <bpel:correlationSet name="OP0_CS" properties="tns:op0_CS"/>
     </bpel:correlationSets>
    
    <!-- ================================================================= -->         
    <!-- ORCHESTRATION LOGIC                                               -->
    <!-- Set of activities coordinating the flow of messages across the    -->
    <!-- services integrated within this business process                  -->
    <!-- ================================================================= -->         
    <bpel:sequence name="main">
        
        <!-- Receive input from requestor. 
             Note: This maps to operation defined in AdditiveSplitting.wsdl 
             -->
        
        <bpel:receive name="receiveInput" partnerLink="client"
                 portType="tns:AdditiveSplitting"
                 operation="initiate" variable="input"
                 createInstance="yes">
		 <bpel:correlations>
             <!--     <bpel:correlation initiate="yes" set="JOB_CS"/>-->
                <bpel:correlation initiate="yes" set="SUB_JOB_CS"/>
            </bpel:correlations>
        </bpel:receive>
       
        
        
        <bpel:assign name="Assign" validate="no">
            <bpel:copy><bpel:from><bpel:literal><tns:AdditiveSplittingResponse xmlns:tns="http://additivesplitting.bpelprocess" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:result>tns:result</tns:result>
  <tns:instanceID>tns:instanceID</tns:instanceID>
</tns:AdditiveSplittingResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="output" part="payload"></bpel:to>
            
            </bpel:copy><bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:input]]></bpel:query>
                </bpel:from>
                <bpel:to variable="JOB" />
            </bpel:copy>
            <bpel:copy>
                <bpel:from>
                    <![CDATA[string($ode:pid)]]>
                </bpel:from>
                <bpel:to part="payload" variable="output">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:instanceID]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <![CDATA[concat($input.payload/tns:matA, $input.payload/tns:matB)]]>
                </bpel:from>
                <bpel:to part="payload" variable="output">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:result]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        
        
        </bpel:assign>
        <bpel:reply name="replyOutput" operation="initiate" partnerLink="client" portType="tns:AdditiveSplitting" variable="output" />
        <bpel:assign validate="no" name="AssignResplit">
            <bpel:copy>
                <bpel:from><bpel:literal xml:space="preserve"><ws:resplit xmlns:ws="http://www.brokerservices.org/MatServ/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <op_id>0</op_id>
  <job_id>job_id</job_id>
  <matA_ID>matA_ID</matA_ID>
  <matB_ID>matB_ID</matB_ID>
  <callback>resplit_callBack</callback>
</ws:resplit></bpel:literal></bpel:from>
                <bpel:to variable="resplit_PLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <![CDATA[$input.payload/tns:sub_jobID]]>
                </bpel:from>
                <bpel:to part="parameters" variable="resplit_PLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[job_id]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <![CDATA[$input.payload/tns:matA_ID]]>
                </bpel:from>
                <bpel:to part="parameters" variable="resplit_PLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matA_ID]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <![CDATA[$input.payload/tns:matB_ID]]>
                </bpel:from>
                <bpel:to part="parameters" variable="resplit_PLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matB_ID]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeResplit" partnerLink="OnBroker_PL" operation="resplit" portType="ns1:MatServ" inputVariable="resplit_PLRequest">
            <bpel:correlations>
                <bpel:correlation set="OP0_CS" initiate="yes" ></bpel:correlation>
            </bpel:correlations>
        </bpel:invoke>
        
        <bpel:receive name="Receive" partnerLink="callback_PL" operation="resplit_callBack" portType="tns:AdditiveSplitting" variable="callbackRequest_0">
            <bpel:correlations>
                <bpel:correlation set="OP0_CS" initiate="no"></bpel:correlation>
                <bpel:correlation set="SUB_JOB_CS" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        
        <bpel:flow name="Flow">
            <bpel:sequence name="A1B1">
                <bpel:assign name="Assign1" validate="no">
                    
                    <bpel:copy>
                        <bpel:from><bpel:literal xml:space="preserve"><ws:multiply xmlns:ws="http://www.cloudservices.org/MatServ/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <op_id>1</op_id>
  <job_id>job_id</job_id>
  <matA_ID>matA_ID</matA_ID>
  <matB_ID>matB_ID</matB_ID>
  <callback>callBack_Operation1</callback>
</ws:multiply>
</bpel:literal></bpel:from>
                        <bpel:to variable="A1B1_PLRequest" part="parameters"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from variable="JOB"/>
                        <bpel:to part="parameters" variable="A1B1_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[job_id]]>
                            </bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[1]/tns:splitA_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A1B1_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matA_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[1]/tns:splitB_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A1B1_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matB_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[string(1)]]>
                        </bpel:from>
                        <bpel:to property="tns:op1_CS" variable="A1B1_PLRequest"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[1]/tns:cloud_url]]>
                        </bpel:from>
                        <bpel:to partnerLink="OnCloud1_PL"></bpel:to>
                    </bpel:copy>
                </bpel:assign>       
                <bpel:invoke name="Mult_A1B1" operation="multiply"
                    partnerLink="OnCloud1_PL" portType="ns:MatServ" inputVariable="A1B1_PLRequest"/>
                <bpel:receive name="CB_A1_B1" operation="callBack_Operation1"
                    partnerLink="client" portType="tns:AdditiveSplitting" variable="callbackRequest_1">
                    <bpel:correlations>
                        <bpel:correlation initiate="no" set="OP1_CS"/>
                        <bpel:correlation set="SUB_JOB_CS" initiate="no"></bpel:correlation>
                    </bpel:correlations>
                </bpel:receive>
                
                
                
            </bpel:sequence>
            <bpel:sequence name="A2B2">
                        
                <bpel:assign name="Assign2" validate="no"><bpel:copy>
                        <bpel:from><bpel:literal xml:space="preserve"><ws:multiply xmlns:ws="http://www.cloudservices.org/MatServ/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <op_id>2</op_id>
  <job_id>job_id</job_id>
  <matA_ID>matA_ID</matA_ID>
  <matB_ID>matB_ID</matB_ID>
  <callback>callBack_Operation1</callback>
</ws:multiply>
</bpel:literal></bpel:from>
                        <bpel:to variable="A2B2_PLRequest" part="parameters"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from variable="JOB" />
                        <bpel:to part="parameters" variable="A2B2_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[job_id]]>
                            </bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[2]/tns:splitA_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A2B2_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matA_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[2]/tns:splitB_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A2B2_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matB_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[string(2)]]>
                        </bpel:from>
                        <bpel:to property="tns:op2_CS" variable="A2B2_PLRequest"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[2]/tns:cloud_url]]>
                        </bpel:from>
                        <bpel:to partnerLink="OnCloud2_PL"></bpel:to>
                    </bpel:copy>
                
                </bpel:assign>
                <bpel:invoke name="Mult_A2B2" partnerLink="OnCloud2_PL" operation="multiply" portType="ns:MatServ" inputVariable="A2B2_PLRequest"/>
                <bpel:receive name="CB_A2B2" operation="callBack_Operation1"
                    partnerLink="callback_PL" portType="tns:AdditiveSplitting" variable="callbackRequest_2">
                    <bpel:correlations>
                        <bpel:correlation initiate="no" set="OP2_CS"/>
                        <bpel:correlation set="SUB_JOB_CS" initiate="no"></bpel:correlation>
                    </bpel:correlations>
                </bpel:receive>
                
                
                
            </bpel:sequence>
            <bpel:sequence name="A1B2">
                 <bpel:assign name="Assign3" validate="no">
                    
                    <bpel:copy>
                        <bpel:from><bpel:literal xml:space="preserve"><ws:multiply xmlns:ws="http://www.cloudservices.org/MatServ/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <op_id>3</op_id>
  <job_id>job_id</job_id>
  <matA_ID>matA_ID</matA_ID>
  <matB_ID>matB_ID</matB_ID>
  <callback>callBack_Operation1</callback>
</ws:multiply>
</bpel:literal></bpel:from>
                        <bpel:to variable="A1B2_PLRequest" part="parameters"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from variable="JOB"/>
                        <bpel:to part="parameters" variable="A1B2_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[job_id]]>
                            </bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[3]/tns:splitA_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A1B2_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matA_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[3]/tns:splitB_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A1B2_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matB_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[string(3)]]>
                        </bpel:from>
                        <bpel:to property="tns:op3_CS" variable="A1B2_PLRequest"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[3]/tns:cloud_url]]>
                        </bpel:from>
                        <bpel:to partnerLink="OnCloud3_PL"></bpel:to>
                    </bpel:copy>
                </bpel:assign>       
              <bpel:invoke name="Mult_A1B2" partnerLink="OnCloud3_PL" operation="multiply" portType="ns:MatServ" inputVariable="A1B2_PLRequest"/>
                <bpel:receive name="CB_A1B2" operation="callBack_Operation1"
                    partnerLink="callback_PL" portType="tns:AdditiveSplitting" variable="callbackRequest_3">
                    <bpel:correlations>
                        <bpel:correlation initiate="no" set="SUB_JOB_CS"/>
                        <bpel:correlation set="OP3_CS" initiate="no"></bpel:correlation>
                    </bpel:correlations>
                </bpel:receive>
                
                
                
            </bpel:sequence>
            <bpel:sequence name="A2B1">
                 <bpel:assign name="Assign4" validate="no">
                    
                    <bpel:copy>
                        <bpel:from><bpel:literal xml:space="preserve"><ws:multiply xmlns:ws="http://www.cloudservices.org/MatServ/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <op_id>4</op_id>
  <job_id>job_id</job_id>
  <matA_ID>matA_ID</matA_ID>
  <matB_ID>matB_ID</matB_ID>
  <callback>callBack_Operation1</callback>
</ws:multiply>
</bpel:literal></bpel:from>
                        <bpel:to variable="A2B1_PLRequest" part="parameters"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from variable="JOB"/>
                        <bpel:to part="parameters" variable="A2B1_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[job_id]]>
                            </bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[4]/tns:splitA_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A2B1_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matA_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[4]/tns:splitB_name]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="A2B1_PLRequest">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[matB_ID]]></bpel:query>
                        </bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[string(4)]]>
                        </bpel:from>
                        <bpel:to property="tns:op4_CS" variable="A2B1_PLRequest"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from>
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA[$callbackRequest_0.parameters/tns:split[4]/tns:cloud_url]]>
                        </bpel:from>
                        <bpel:to partnerLink="OnCloud4_PL"></bpel:to>
                    </bpel:copy>
                </bpel:assign>       
              
                      <bpel:invoke name="Mult_A2B1" partnerLink="OnCloud4_PL" operation="multiply" portType="ns:MatServ" inputVariable="A2B1_PLRequest"/>
                <bpel:receive name="CB_A2B1" operation="callBack_Operation1"
                    partnerLink="callback_PL" portType="tns:AdditiveSplitting" variable="callbackRequest_4">
                    <bpel:correlations>
                        <bpel:correlation initiate="no" set="SUB_JOB_CS"/>
                        <bpel:correlation set="OP4_CS" initiate="no"></bpel:correlation>
                    </bpel:correlations>
                </bpel:receive>
                
                
                
            </bpel:sequence>
        </bpel:flow>
        
        
        
        
        <bpel:assign name="Assign5" validate="no">
            
            <bpel:copy>
                <bpel:from><bpel:literal xml:space="preserve"><ws:add xmlns:ws="http://www.brokerservices.org/MatServ/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <op_id>5</op_id>
  <job_id>job_id</job_id>
  <matA_ID>matA_ID</matA_ID>
  <matB_ID>matB_ID</matB_ID>
  <callback>callBack_Operation1</callback>
</ws:add>
</bpel:literal></bpel:from>
                <bpel:to variable="add_PLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy keepSrcElementName="no">
                <bpel:from>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <![CDATA[$input.payload/tns:matA_ID]]>
                </bpel:from>
                <bpel:to part="parameters" variable="add_PLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[matA_ID]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <![CDATA[$input.payload/tns:matB_ID]]>
                </bpel:from>
                <bpel:to part="parameters" variable="add_PLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[matB_ID]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="JOB"></bpel:from>
                <bpel:to part="parameters" variable="add_PLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[job_id]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        
        </bpel:assign>
        <bpel:invoke name="Add"
            operation="add" partnerLink="OnBroker_PL" portType="ns1:MatServ" inputVariable="add_PLRequest"/>
        <bpel:receive name="Receive2" operation="callBack_Operation1"
            partnerLink="callback_PL" portType="tns:AdditiveSplitting" variable="callbackRequest_5">
            <bpel:correlations>
                <bpel:correlation initiate="no" set="SUB_JOB_CS"/>
            </bpel:correlations>
        </bpel:receive>
 
      
        
    </bpel:sequence>
</bpel:process>

